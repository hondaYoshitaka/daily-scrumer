extends ../layout


block stylesheet
    link(rel='stylesheet', href='/stylesheets/jquery.one-day-calendar.css')
    link(rel='stylesheet', href='/stylesheets/daily.css')

block javascript
    script(src='/javascripts/handlebars.template.daily.js')
    script(src='/javascripts/jquery.rate-circle.js')
    script(src='/javascripts/jquery.one-day-calendar.js')
    script(src='/javascripts/view.daily.js')
    script
        CS.sprint = !{JSON.stringify(sprint)};


block content

    - var placeholder = msg.placeholder.daily;
    - var label = msg.label.daily;
    - var btn = msg.btn.daily;

    section#calendar-section.float-right.positioned
        #calendar-cover.cover(data-role='date-display')
        #calendar.calendar


    h2#current-sprint-title.etched
        small.sub-title
            | #{msg.label.current_sprint}
            br
        - if(sprint)
            span.large sprint#{sprint.number}

        section#traffic-light-section.inline-section
            .traffic-light-box
                // TODO 日本とイギリス以外は緑が右？
                .traffic-light.traffic-light-green(data-role='traffic-light')
                .traffic-light.traffic-light-yellow(data-role='traffic-light')
                .traffic-light.traffic-light-red.on(data-role='traffic-light')
    .etched-line#top-line
    br



    section#task-section.paper.float-left
        .paper-content
            h3.paper-title
                | #{label.tasks}
            span.rate-box.float-right.positioned
                #task-done-rate-circle.rate-circle
                span#task-done-rate.suffix-rate.rate-number
            table
                tr
                    th #{label.task_time.estimated}
                    td.number-data
                        span(data-key='estimated').suffix-hour
                tr
                    th #{label.task_time.remain}
                    td.number-data
                        span(data-key='remain').suffix-hour
                tr
                    th #{label.task_time.consumed}
                    td.number-data
                        span(data-key='consumed').suffix-hour





    section#bugs-section.paper.float-left
        .paper-content
            h3.paper-title.blue
                | #{label.bugs}
            span.rate-box.float-right.positioned
                #bug-done-rate-circle.rate-circle
                span#bug-done-rate.suffix-rate.rate-number
            table
                tr
                    th #{label.bug_count.open}
                    td.number-data
                        span(data-key='open').suffix-ticket
                tr
                    th #{label.bug_count.modified}
                    td.number-data
                        span(data-key='modified').suffix-ticket
                tr
                    th #{label.bug_count.done}
                    td.number-data
                        span(data-key='done').suffix-ticket

    br.clear


    .etched-line

    section#keep-in-mind-section
        .photo-panel-container
            .photo-panel
                .frame-bar-top.photo-frame-bar
                .frame-bar-bottom.photo-frame-bar
                .frame-bar-left.photo-frame-bar
                .frame-bar-right.photo-frame-bar
                .photo-inner-frame
                    form#keep-in-mind-form(action='/sprint/update_keep_in_mind', method='POST')
                        input(type='hidden', name='_id', value=sprint&&sprint._id)
                        ol.keep-in-mind-list
                            - var keepInMindMaxLength = 120;
                            - var trialDefault = '(none)';
                            li.keep-in-mind-list-item
                                input(name='keep_in_mind_0',
                                    maxlength = keepInMindMaxLength,
                                    value=sprint.keep_in_mind_0 || trialDefault,
                                    placeholder=placeholder.keep_in_mind[0])
                            li.keep-in-mind-list-item
                                input(name='keep_in_mind_1',
                                    maxlength = keepInMindMaxLength,
                                    value=sprint.keep_in_mind_1 || trialDefault,
                                    placeholder=placeholder.keep_in_mind[1])
                            li.keep-in-mind-list-item
                                input(name='keep_in_mind_2',
                                    maxlength =keepInMindMaxLength,
                                    value=sprint.keep_in_mind_2 || trialDefault,
                                    placeholder=placeholder.keep_in_mind[2])
            .name-plate-container
                .name-plate
                    | #{label.keep_in_mind}

    br.clear
    .etched-line
    br
    section#grouping-section.paper.inline.float-left
        .paper-content.unselectable
            h3.paper-title #{label.grouping}
            #grouping-roulette

                br.clear
                a.btn.stick-right.stick-top#grouping-shuffle-btn
                    | #{btn.shuffle}
                a.btn.stick-right.stick-top#grouping-stop-btn.primary
                    | #{btn.shuffle_stop}
                #grouping-absentee-area
                    span.half-transparent #{label.grouping_absentee}
            .float-right
    section#availabel-group-section.paper.inline.float-left
        .paper-content
            h3.paper-title #{label.available_group}
            .number-data
                span#availabel-group-count.extra-large.italic.suffix-group
                | ×
                span.suffix-hour
                    input.shortest(
                        type='number',
                        name='hour',
                        value='5',
                        max='8',
                        min='0'
                    )
    br.clear
    br
    .etched-line
    br
